<html lang="en"><head>
  <meta charset="UTF-8">
  <title>FriendFinder</title>

  <!-- Latest compiled and minified CSS & JS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

  <!-- Font Awesome Glyphicons -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">

</head>

<body>
  <div class="container">
    <h2>Survey Questions</h2>
    <hr>
    <h3><strong>About You</strong></h3>
    <h4>Name (Required)</h4>
    <input type="text" name="" id="name" class="form-control" required>
    <h4>Link to photo (Required)</h4>
    <input type="text" name="" id="photo" class="form-control" required>
    <hr>
    <section id="friend-form">
      <section class="form-group">
        <h3>Question 1</h3>
        <label for="q1" class="control-label">
          I am adventurous.
        </label>
        <div>
          <select class="chosen select" id="q1">
            <option value="" selected disabled>Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
      </section>
      <section class="form-group">
        <h3>Question 2</h3>
        <label for="q2" class="control-label">
          If you had a pet it would be a dog.
        </label>
        <div>
          <select class="chosen select" id="q2">
            <option value="" selected disabled>Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
      </section>
      <section class="form-group">
        <h3>Question 3</h3>
        <label for="q3" class="control-label">
          You like to go for a walk when you feel stressed out.
        </label>
        <div>
          <select class="chosen select" id="q3">
            <option value="" selected disabled>Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
      </section>
      <section class="form-group">
        <h3>Question 4</h3>
        <label for="q4" class="control-label">
          When you go out you want pizza.
        </label>
        <div>
          <select class="chosen select" id="q4">
            <option value="" selected disabled>Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
      </section>
      <section class="form-group">
        <h3>Question 5</h3>
        <label for="q5" class="control-label">
          Chocolate is better than vanilla.
        </label>
        <div>
          <select class="chosen select" id="q5">
            <option value="" selected disabled>Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
      </section>
      <section class="form-group">
        <h3>Question 6</h3>
        <label for="q6" class="control-label">
          You make spontaneous decisions.
        </label>
        <div>
          <select class="chosen select" id="q6">
            <option value="" selected disabled>Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
      </section>
      <section class="form-group">
        <h3>Question 7</h3>
        <label for="q7" class="control-label">
          Any dog less than 30 pounds is considered a cat.
        </label>
        <div>
          <select class="chosen select" id="q7">
            <option value="" selected disabled>Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
      </section>
      <section class="form-group">
        <h3>Question 8</h3>
        <label for="q8" class="control-label">
          You day dream constantly.
        </label>
        <div>
          <select class="chosen select" id="q8">
            <option value="" selected disabled>Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
      </section>
      <section class="form-group">
        <h3>Question 9</h3>
        <label for="q9" class="control-label">
          You like country music.
        </label>
        <div>
          <select class="chosen select" id="q9">
            <option value="" selected disabled>Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
      </section>
      <section class="form-group">
        <h3>Question 10</h3>
        <label for="q10" class="control-label">
          You enjoy football.
        </label>
        <div>
          <select class="chosen select" id="q10">
            <option value="" selected disabled>Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
      </section>
    </section>
    
    <div class="modal">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title"></h4>
          </div>
          <div class="modal-body text-center">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
    <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit"><i class="fa fa-check-circle" aria-hidden="true"></i>
      Submit</button>

    <hr>
    <footer class="footer">
      <div class="container">
        <p><a href="/api/friends">API Friends List</a> | <a href="https://github.com/griffinhall2/friendfinder">GitHub Repo</a></p>
      </div>
    </footer>
  </div>
  <script type="text/javascript">
    
    $("#submit").on("click", function (event) {
      
      event.preventDefault();
      // Set local variables
      var matchStatus = $(".modal-title");
      var modalBody = $(".modal-body");
      // set responses to local variables
      var name = $("#name").val().trim();
      var photo = $("#photo").val();
      var q1 = parseInt($("#q1").val());
      var q2 = parseInt($("#q2").val());
      var q3 = parseInt($("#q3").val());
      var q4 = parseInt($("#q4").val());
      var q5 = parseInt($("#q5").val());
      var q6 = parseInt($("#q6").val());
      var q7 = parseInt($("#q7").val());
      var q8 = parseInt($("#q8").val());
      var q9 = parseInt($("#q9").val());
      var q10 = parseInt($("#q10").val());
     
      var userData = {
        name: name,
        photo: photo,
        scores: [
          q1,
          q2,
          q3,
          q4,
          q5,
          q6,
          q7,
          q8,
          q9,
          q10,
        ]
      };
    
      if (
        (name !== '') && (photo !== '') && (!isNaN(q1)) &&
        (!isNaN(q2)) && (!isNaN(q3)) && (!isNaN(q4)) &&
        (!isNaN(q5)) && (!isNaN(q6)) && (!isNaN(q7)) &&
        (!isNaN(q8)) && (!isNaN(q9)) && (!isNaN(q10))
      ) {

        var currentURL = window.location.origin;

        $.post(currentURL + "/api/friends", userData, function (data) {

          // if match show
          if (data.name !== undefined) {
            matchStatus.html("Your match...");
            modalBody.html("<p>...is " + data.name + '!</p><img src="' + data.photo + '" height="200">');
          } else {

            // If not a match show
            matchStatus.html("Need more data!");
            modalBody.html("<p>Not enough user data to match you</p>");
          }

          $(".modal").modal("toggle");
        });
      } else {

        //show error
        matchStatus.html("Error");
        modalBody.html("Please answer all of the questions on the form.");

        $(".modal").modal("toggle");
      }
    });
    $("#friend-form").reset();
  </script>
</body>

</html>